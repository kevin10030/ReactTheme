{"ast":null,"code":"var _jsxFileName = \"D:\\\\CSH\\\\A\\\\IoT\\\\Web\\\\Training\\\\trainingapp\\\\web\\\\src\\\\modules\\\\courses\\\\RefundPage.jsx\";\nimport React from \"react\";\nimport { CButton, CCard, CCardBody, CCardHeader, CCardFooter, CCol, CRow, CDataTable, CForm, CFormGroup, CFormText, CLink, CInput, CLabel, CSelect, CInputGroup, CInputGroupPrepend, CInputGroupText } from '@coreui/react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { NavLink as RouterLink, Route, useHistory } from \"react-router-dom\";\nimport MuiAlert from '@material-ui/lab/Alert';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport CIcon from '@coreui/icons-react';\nimport axios from 'axios';\nimport Config from '../../common/Config';\n\nfunction Alert(props) {\n  return /*#__PURE__*/React.createElement(MuiAlert, Object.assign({\n    elevation: 6\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 27,\n      columnNumber: 10\n    }\n  }));\n}\n\nexport default function RefundPage() {\n  const {\n    useState\n  } = React;\n  const history = useHistory(); // const loginUser = useSelector(state => state.loginUser);\n\n  const [loginUser, setLoginUser] = useState({});\n  const [currentPage, setCurrentPage] = useState(1);\n  const [currentPagination, setCurrentPagination] = useState(5);\n\n  const getLastVal = currentPage => {\n    if (currentPage * currentPagination < paymentList.length) return currentPage * currentPagination;\n    return paymentList.length;\n  };\n\n  const fields = [{\n    key: 'useremail',\n    label: 'User Email',\n    _style: {\n      width: '20%'\n    }\n  }, {\n    key: 'coursename',\n    label: 'Course Name',\n    _style: {\n      width: '30%'\n    }\n  }, {\n    key: 'amount',\n    label: 'Amount',\n    _style: {\n      width: '20%'\n    }\n  }, {\n    key: 'paymenttime',\n    label: 'Payment Time',\n    _style: {\n      width: '30%'\n    }\n  }, {\n    key: 'actions',\n    label: '',\n    _style: {\n      width: '1%'\n    },\n    sorter: false,\n    filter: false\n  }];\n  const [adminid, setAdminId] = React.useState(\"adminid\");\n  const [adminemail, setAdminEmail] = React.useState(\"adminemail\");\n  const [toast, showToast] = React.useState(false);\n  const [toastMessage, setToastMessage] = React.useState('');\n  const [toastClass, setToastClass] = React.useState('success');\n  const [loading, setLoading] = React.useState(false);\n  const [paymentList, setPaymentList] = React.useState([]);\n  const [courseList, setCourseList] = React.useState([]);\n  const [refunditem, setRefundItem] = React.useState(null);\n  React.useEffect(() => {\n    if (localStorage.getItem('loginUser')) {\n      var loginUser = JSON.parse(localStorage.getItem('loginUser'));\n      setLoginUser(loginUser);\n      console.log('loginUser2 ===> ' + JSON.stringify(loginUser));\n      setAdminId(loginUser.userId);\n      setAdminEmail(loginUser.email);\n\n      if (loginUser.userrole !== 'admin') {\n        history.push('/');\n      }\n    } else {\n      history.push('/auth/login-page');\n    }\n\n    getCourseList();\n  }, []);\n\n  const getUser = async email => {\n    setLoading(true);\n    axios({\n      url: Config.BACKEND_API_URL + '/user',\n      method: 'get',\n      headers: {\n        'Content-Type': 'application/json',\n        'user-email': email\n      }\n    }).then(function (response) {\n      console.log(response.data);\n      setAdminId(response.data.userId);\n      setLoading(false);\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n  };\n\n  const getPaymentList = async () => {\n    setLoading(true);\n    axios({\n      url: Config.BACKEND_API_URL + '/payment',\n      method: 'get'\n    }).then(response => response.data).then(data => {\n      const list = data.sort((a, b) => a.updatedtime > b.updatedtime ? 1 : -1);\n      console.log(list);\n      setPaymentList(list);\n      setLoading(false);\n    }).catch(error => {\n      setLoading(false);\n    });\n  };\n\n  const getCourseList = async () => {\n    setLoading(true);\n    axios({\n      url: Config.BACKEND_API_URL + '/course',\n      method: 'get'\n    }).then(function (response) {\n      const list = response.data.sort((a, b) => a.updatedtime > b.updatedtime ? 1 : -1);\n      console.log(list);\n      setCourseList(list);\n      setLoading(false);\n      getPaymentList();\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n  };\n\n  const handleRefund = item => {\n    if (refunditem !== null) {// setToastClass('Warning');\n      // setToastMessage('Please process previous refund')\n      // showToast(true)\n    } else setRefundItem(item);\n  };\n\n  const refundPayment = item => {\n    setLoading(true);\n    console.log(item);\n    var chargeid = 'ch_';\n\n    try {\n      chargeid = item.chargeid;\n    } catch (e) {\n      setLoading(false);\n      setToastClass('Warning');\n      setToastMessage(\"Charge id is not valid\");\n      showToast(true);\n      return;\n    }\n\n    console.log(chargeid);\n    axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/refund',\n      method: 'post',\n      data: {\n        'chargeid': chargeid,\n        'paymentid': item.paymentid,\n        'amount': courseList.find(course => course.courseid === item.courseid).price,\n        'adminemail': adminemail,\n        'updatedby': adminid,\n        'updatedtime': Date.now().toString()\n      },\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(response => response.data).then(data => {\n      console.log(data);\n      setLoading(false);\n      setToastClass('success');\n      setToastMessage('Success: ' + data);\n      showToast(true);\n      setRefundItem(null);\n    }).catch(error => {\n      console.log(error);\n      setLoading(false);\n      setToastClass('Warning');\n      setToastMessage(error.response.data);\n      showToast(true);\n      setRefundItem(null);\n    });\n  };\n\n  function getDateTimeString(timestamp) {\n    const date = new Date(Number(timestamp));\n    return date.toLocaleString(\"en-US\");\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"animated fadeIn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    xl: \"12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CCard, {\n    custom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CCardHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 13\n    }\n  }, \"Payment Transactions\"), /*#__PURE__*/React.createElement(CCardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CDataTable, {\n    items: paymentList,\n    fields: fields // columnFilter\n    ,\n    tableFilter: true // footer\n    ,\n    itemsPerPageSelect: false,\n    itemsPerPage: currentPagination,\n    dark: false,\n    hover: false,\n    border: false,\n    outlined: false,\n    loading: false,\n    sorter: false // clickableRows\n    ,\n    pagination: {\n      doubleArrows: true,\n      align: 'center'\n    },\n    loading: loading // onRowClick={(item,index,col,e) => {console.log(item,index,col,e)}}\n    ,\n    onPageChange: val => {\n      setCurrentPage(val);\n    } // onPagesChange={(val) => console.log('new pages:', val)}\n    ,\n    onPaginationChange: val => {\n      setCurrentPagination(val);\n    } // onFilteredItemsChange={(val) => console.log('new filtered items:', val)}\n    // onSorterValueChange={(val) => console.log('new sorter value:', val)}\n    // onTableFilterChange={(val) => console.log('new table filter:', val)}\n    // onColumnFilterChange={(val) => console.log('new column filter:', val)}\n    ,\n    scopedSlots: {\n      'coursename': item => /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 21\n        }\n      }, courseList.find(course => course.courseid === item.courseid).coursename),\n      'amount': item => /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 21\n        }\n      }, courseList.find(course => course.courseid === item.courseid).price + \" \" + courseList.find(course => course.courseid === item.courseid).currency),\n      'paymenttime': item => /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 21\n        }\n      }, getDateTimeString(item.updatedtime)),\n      'actions': item => {\n        return /*#__PURE__*/React.createElement(\"td\", {\n          className: \"py-2\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 270,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(CButton, {\n          size: \"sm\",\n          color: \"danger\",\n          className: \"ml-1\",\n          onClick: e => {\n            e.preventDefault();\n            handleRefund(item);\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 27\n          }\n        }, \"Refund\"));\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(CRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    xs: \"9\",\n    md: \"8\",\n    style: {\n      alignSelf: \"center\",\n      display: 'flex'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"spin\", {\n    style: {\n      marginTop: \"5px\",\n      marginRight: \"5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 21\n    }\n  }, \"Items per page:\"), /*#__PURE__*/React.createElement(CSelect, {\n    name: \"itemsperpage\",\n    id: \"itemsperpage\",\n    style: {\n      width: \"70px\"\n    },\n    onChange: e => setCurrentPagination(e.target.value),\n    value: currentPagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 23\n    }\n  }, \"5\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 23\n    }\n  }, \"10\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"15\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 23\n    }\n  }, \"15\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 23\n    }\n  }, \"20\"))), /*#__PURE__*/React.createElement(CCol, {\n    xs: \"3\",\n    md: \"4\",\n    style: {\n      alignSelf: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: 'right'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"spin\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 21\n    }\n  }, (currentPage - 1) * currentPagination + 1 + '-' + getLastVal(currentPage) + ' of ' + paymentList.length))))))), /*#__PURE__*/React.createElement(CCol, {\n    sm: \"12\",\n    lg: \"12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CRow, {\n    className: \"justify-content-center\",\n    hidden: refunditem === null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    severity: 'info',\n    color: 'info',\n    action: /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(CButton, {\n      color: \"danger\",\n      style: {\n        width: \"50px\",\n        marginRight: \"5px\"\n      },\n      onClick: e => {\n        e.preventDefault();\n        refundPayment(refunditem);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 21\n      }\n    }, \"YES\"), /*#__PURE__*/React.createElement(CButton, {\n      color: \"danger\",\n      style: {\n        width: \"50px\"\n      },\n      onClick: e => {\n        e.preventDefault();\n        setRefundItem(null);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 21\n      }\n    }, \"NO\")),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 15\n    }\n  }, 'Do yo want to perform refund?'))), /*#__PURE__*/React.createElement(CCol, {\n    sm: \"12\",\n    lg: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Snackbar, {\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'center'\n    },\n    open: toast,\n    autoHideDuration: 10000,\n    onClose: () => {\n      showToast(false);\n      getPaymentList();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    severity: toastClass,\n    action: /*#__PURE__*/React.createElement(CButton, {\n      onClick: e => {\n        e.preventDefault();\n        showToast(false);\n        getPaymentList();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(CIcon, {\n      name: \"cil-x\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 105\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 13\n    }\n  }, toastMessage)))));\n}","map":{"version":3,"sources":["D:/CSH/A/IoT/Web/Training/trainingapp/web/src/modules/courses/RefundPage.jsx"],"names":["React","CButton","CCard","CCardBody","CCardHeader","CCardFooter","CCol","CRow","CDataTable","CForm","CFormGroup","CFormText","CLink","CInput","CLabel","CSelect","CInputGroup","CInputGroupPrepend","CInputGroupText","useSelector","useDispatch","NavLink","RouterLink","Route","useHistory","MuiAlert","Snackbar","CIcon","axios","Config","Alert","props","RefundPage","useState","history","loginUser","setLoginUser","currentPage","setCurrentPage","currentPagination","setCurrentPagination","getLastVal","paymentList","length","fields","key","label","_style","width","sorter","filter","adminid","setAdminId","adminemail","setAdminEmail","toast","showToast","toastMessage","setToastMessage","toastClass","setToastClass","loading","setLoading","setPaymentList","courseList","setCourseList","refunditem","setRefundItem","useEffect","localStorage","getItem","JSON","parse","console","log","stringify","userId","email","userrole","push","getCourseList","getUser","url","BACKEND_API_URL","method","headers","then","response","data","catch","error","getPaymentList","list","sort","a","b","updatedtime","handleRefund","item","refundPayment","chargeid","e","process","env","REACT_APP_AWS_API_ENDPOINT","paymentid","find","course","courseid","price","Date","now","toString","getDateTimeString","timestamp","date","Number","toLocaleString","doubleArrows","align","val","coursename","currency","preventDefault","alignSelf","display","marginTop","marginRight","target","value","textAlign","vertical","horizontal"],"mappings":"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","sourcesContent":["import React from \"react\";\r\n\r\nimport {\r\n  CButton,\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CCardFooter,\r\n  CCol,\r\n  CRow, CDataTable, CForm, CFormGroup, CFormText, CLink, CInput, CLabel, CSelect,\r\n  CInputGroup,\r\n  CInputGroupPrepend,\r\n  CInputGroupText,\r\n} from '@coreui/react'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { NavLink as RouterLink, Route, useHistory } from \"react-router-dom\";\r\n\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\n\r\nimport CIcon from '@coreui/icons-react'\r\nimport axios from 'axios';\r\nimport Config from '../../common/Config'\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} {...props} />;\r\n}\r\n\r\n\r\nexport default function RefundPage() {\r\n  const { useState } = React;\r\n  const history = useHistory();\r\n  // const loginUser = useSelector(state => state.loginUser);\r\n  const [loginUser, setLoginUser] = useState({})\r\n\r\n  const [currentPage, setCurrentPage] = useState(1)\r\n  const [currentPagination, setCurrentPagination] = useState(5)\r\n  const getLastVal = (currentPage) => {\r\n    if (currentPage * currentPagination < paymentList.length)\r\n      return currentPage * currentPagination;\r\n    return paymentList.length;\r\n  }\r\n  const fields = [\r\n    { key: 'useremail', label:'User Email', _style: { width: '20%' } },\r\n    { key: 'coursename', label:'Course Name', _style: { width: '30%' } },\r\n    { key: 'amount', label:'Amount', _style: { width: '20%' } },\r\n    { key: 'paymenttime', label:'Payment Time', _style: { width: '30%' } },\r\n    {\r\n      key: 'actions',\r\n      label: '',\r\n      _style: { width: '1%' },\r\n      sorter: false,\r\n      filter: false\r\n    },\r\n  ]\r\n\r\n  const [adminid, setAdminId] = React.useState(\"adminid\")\r\n  const [adminemail, setAdminEmail] = React.useState(\"adminemail\")\r\n\r\n  const [toast, showToast] = React.useState(false);\r\n  const [toastMessage, setToastMessage] = React.useState('');\r\n  const [toastClass, setToastClass] = React.useState('success');\r\n\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [paymentList, setPaymentList] = React.useState([])\r\n  const [courseList, setCourseList] = React.useState([])\r\n\r\n  const [refunditem, setRefundItem] = React.useState(null)\r\n\r\n  React.useEffect(() => {\r\n    if(localStorage.getItem('loginUser')) {\r\n      var loginUser = JSON.parse(localStorage.getItem('loginUser'))\r\n      setLoginUser(loginUser)\r\n      console.log('loginUser2 ===> ' + JSON.stringify(loginUser));\r\n      setAdminId(loginUser.userId);\r\n      setAdminEmail(loginUser.email);\r\n      if(loginUser.userrole !== 'admin') {\r\n        history.push('/');\r\n      }\r\n    } else {\r\n      history.push('/auth/login-page');\r\n    }\r\n\r\n    getCourseList();\r\n  }, []);\r\n\r\n  const getUser = async (email) => {\r\n    setLoading(true)\r\n    axios({\r\n      url: Config.BACKEND_API_URL+'/user',\r\n      method: 'get' ,\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        'user-email': email\r\n      }\r\n    })\r\n    .then(function (response) {\r\n      console.log(response.data)\r\n      setAdminId(response.data.userId)\r\n      setLoading(false)\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n  };\r\n\r\n  const getPaymentList = async () => {\r\n    setLoading(true)\r\n\r\n    axios({\r\n      url: Config.BACKEND_API_URL + '/payment',\r\n      method: 'get'\r\n    }).then(response => response.data).then((data) => {\r\n      const list = data.sort((a, b) => a.updatedtime > b.updatedtime ? 1 : -1)\r\n      console.log(list)\r\n      setPaymentList(list);\r\n      setLoading(false)\r\n    }).catch(error => {\r\n      setLoading(false)\r\n    });\r\n  };\r\n\r\n  const getCourseList = async () => {\r\n    setLoading(true)\r\n    axios({\r\n      url: Config.BACKEND_API_URL+'/course',\r\n      method: 'get'\r\n    })\r\n    .then(function (response) {\r\n      const list = response.data.sort((a, b) => a.updatedtime > b.updatedtime ? 1 : -1)\r\n      console.log(list)\r\n      setCourseList(list);\r\n      setLoading(false)\r\n      getPaymentList()\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n  };\r\n\r\n  const handleRefund = (item) => {\r\n    if(refunditem !==null) {\r\n      // setToastClass('Warning');\r\n      // setToastMessage('Please process previous refund')\r\n      // showToast(true)\r\n    } else\r\n      setRefundItem(item);\r\n  }\r\n\r\n  const refundPayment = (item) => {\r\n    setLoading(true)\r\n    console.log(item)\r\n    var chargeid = 'ch_'\r\n    try{\r\n      chargeid = item.chargeid;\r\n    }catch(e){\r\n      setLoading(false)\r\n      setToastClass('Warning');\r\n      setToastMessage(\"Charge id is not valid\");\r\n      showToast(true);\r\n      return;\r\n    }\r\n\r\n    console.log(chargeid)\r\n    axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/refund',\r\n      method: 'post',\r\n      data: {\r\n        'chargeid': chargeid,\r\n        'paymentid': item.paymentid,\r\n        'amount': courseList.find(course => course.courseid === item.courseid).price,\r\n        'adminemail':adminemail,\r\n        'updatedby': adminid,\r\n        'updatedtime': Date.now().toString()\r\n      },\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    }).then(response => response.data).then((data) => {\r\n      console.log(data)\r\n      setLoading(false)\r\n      setToastClass('success');\r\n      setToastMessage('Success: ' + data);\r\n      showToast(true);\r\n      setRefundItem(null);\r\n    }).catch(error => {\r\n      console.log(error)\r\n      setLoading(false)\r\n      setToastClass('Warning');\r\n      setToastMessage(error.response.data);\r\n      showToast(true);\r\n      setRefundItem(null);\r\n    })\r\n  }\r\n\r\n  function getDateTimeString(timestamp)\r\n  {\r\n    const date =  new Date(Number(timestamp));\r\n    return date.toLocaleString(\"en-US\");\r\n  }\r\n\r\n  return (\r\n    <div className=\"animated fadeIn\">\r\n      <CRow>\r\n        <CCol xl=\"12\">\r\n          <CCard custom>\r\n            <CCardHeader >\r\n              Payment Transactions\r\n            </CCardHeader>\r\n            <CCardBody>\r\n              <CDataTable\r\n                items={paymentList}\r\n                fields={fields}\r\n                // columnFilter\r\n                tableFilter\r\n                // footer\r\n                itemsPerPageSelect={false}\r\n                itemsPerPage={currentPagination}\r\n                dark={false}\r\n                hover={false}\r\n                border={false}\r\n                outlined={false}\r\n                loading={false}\r\n                sorter={false}\r\n                // clickableRows\r\n                pagination={{ doubleArrows: true, align: 'center' }}\r\n                loading={loading}\r\n                // onRowClick={(item,index,col,e) => {console.log(item,index,col,e)}}\r\n                onPageChange={(val) => {\r\n                  setCurrentPage(val)\r\n                  }\r\n                }\r\n                // onPagesChange={(val) => console.log('new pages:', val)}\r\n                onPaginationChange={(val) => {\r\n                  setCurrentPagination(val);\r\n                }}\r\n                // onFilteredItemsChange={(val) => console.log('new filtered items:', val)}\r\n                // onSorterValueChange={(val) => console.log('new sorter value:', val)}\r\n                // onTableFilterChange={(val) => console.log('new table filter:', val)}\r\n                // onColumnFilterChange={(val) => console.log('new column filter:', val)}\r\n                scopedSlots={{\r\n                  'coursename':\r\n                  (item) => (\r\n                    <td>\r\n                      {\r\n                        courseList.find(course => course.courseid === item.courseid).coursename\r\n                      }\r\n                    </td>\r\n                  ),\r\n                  'amount':\r\n                  (item) => (\r\n                    <td>\r\n                      {\r\n                        courseList.find(course => course.courseid === item.courseid).price + \" \" + courseList.find(course => course.courseid === item.courseid).currency\r\n                      }\r\n                    </td>\r\n                  ),\r\n                  'paymenttime':\r\n                  (item) => (\r\n                    <td>\r\n                      { getDateTimeString(item.updatedtime) }\r\n                    </td>\r\n                  ),\r\n                  'actions':\r\n                    item => {\r\n                      return (\r\n                        <td className=\"py-2\">\r\n                          <CButton size=\"sm\" color=\"danger\" className=\"ml-1\" onClick={(e) =>\r\n                            {\r\n                              e.preventDefault();\r\n                              handleRefund(item)\r\n\r\n                            }}>\r\n                            Refund\r\n                          </CButton>\r\n                        </td>\r\n                      )\r\n                    }\r\n                }}\r\n              />\r\n              <CRow>\r\n                <CCol xs=\"9\" md=\"8\" style={{alignSelf:\"center\", display:'flex'}}>\r\n                    <spin style={{marginTop:\"5px\", marginRight:\"5px\"}}>Items per page:</spin>\r\n                    <CSelect\r\n                      name=\"itemsperpage\"\r\n                      id=\"itemsperpage\"\r\n                      style={{width:\"70px\"}}\r\n                      onChange={e => setCurrentPagination(e.target.value)}\r\n                      value={currentPagination}>\r\n                      <option value=\"5\">5</option>\r\n                      <option value=\"10\">10</option>\r\n                      <option value=\"15\">15</option>\r\n                      <option value=\"20\">20</option>\r\n                    </CSelect>\r\n                </CCol>\r\n                <CCol xs=\"3\" md=\"4\" style={{alignSelf:\"center\"}}>\r\n                  <div  style={{textAlign: 'right' }}>\r\n                    <spin>\r\n                    {\r\n                      ((currentPage - 1) * currentPagination + 1) + '-' + getLastVal(currentPage) + ' of ' + paymentList.length\r\n                    }\r\n                    </spin>\r\n                  </div>\r\n                </CCol>\r\n              </CRow>\r\n            </CCardBody>\r\n          </CCard>\r\n        </CCol>\r\n        <CCol sm=\"12\" lg=\"12\" >\r\n            <CRow className=\"justify-content-center\" hidden={refunditem === null} >\r\n              <Alert\r\n                severity={'info'}\r\n                color={'info'}\r\n                action={\r\n                  <div>\r\n                    <CButton color=\"danger\" style={{width:\"50px\",marginRight:\"5px\"}} onClick={(e) => { e.preventDefault(); refundPayment(refunditem); }}>YES</CButton>\r\n                    <CButton color=\"danger\" style={{width:\"50px\"}} onClick={(e) => { e.preventDefault(); setRefundItem(null); }}>NO</CButton>\r\n                  </div>\r\n                }\r\n              >\r\n              {'Do yo want to perform refund?'}\r\n            </Alert>\r\n            </CRow>\r\n        </CCol>\r\n        <CCol sm=\"12\" lg=\"6\">\r\n          <Snackbar\r\n            anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\r\n            open={toast}\r\n            autoHideDuration={10000}\r\n            onClose={() => { showToast(false); getPaymentList(); }}>\r\n            <Alert\r\n              severity={toastClass}\r\n              action={\r\n                <CButton  onClick={(e) => { e.preventDefault(); showToast(false); getPaymentList();  }}><CIcon name=\"cil-x\" /></CButton>\r\n              }\r\n            >\r\n              {toastMessage}\r\n            </Alert>\r\n          </Snackbar>\r\n        </CCol>\r\n      </CRow>\r\n    </div>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}