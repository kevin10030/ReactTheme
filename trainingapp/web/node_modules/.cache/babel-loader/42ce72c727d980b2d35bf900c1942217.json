{"ast":null,"code":"var _jsxFileName = \"D:\\\\CSH\\\\Samples\\\\Theme\\\\ReactTheme\\\\trainingapp\\\\web\\\\src\\\\modules\\\\users\\\\Messages.jsx\";\nimport React, { Component, useEffect } from \"react\";\nimport { CButton, CCard, CCardBody, CCardHeader, CCardFooter, CCol, CRow, CDataTable, CForm, CFormGroup, CFormText, CLink, CInput, CLabel, CSelect, CSpinner, CInputGroup, CInputGroupPrepend, CInputGroupText, CInputFile } from \"@coreui/react\";\nimport Snackbar from '@material-ui/core/Snackbar';\nimport { NavLink as RouterLink, useHistory } from \"react-router-dom\";\nimport MuiAlert from '@material-ui/lab/Alert';\nimport CIcon from '@coreui/icons-react';\nimport axios from 'axios';\nimport Config from '../../common/Config';\n\nfunction Alert(props) {\n  return /*#__PURE__*/React.createElement(MuiAlert, Object.assign({\n    elevation: 6\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 34,\n      columnNumber: 10\n    }\n  }));\n}\n\nexport default function Messages() {\n  const history = useHistory();\n  const [loginUser, setLoginUser] = React.useState({});\n  const [currentPage, setCurrentPage] = React.useState(1);\n  const [currentPagination, setCurrentPagination] = React.useState(5);\n\n  const getLastVal = currentPage => {\n    if (currentPage * currentPagination < messageList.length) return currentPage * currentPagination;\n    return messageList.length;\n  };\n\n  const fields = [{\n    key: \"subject\",\n    label: \"Subject\",\n    _style: {\n      width: \"20%\"\n    }\n  }, {\n    key: \"mobilenumber\",\n    label: \"Mobile Number\",\n    _style: {\n      width: \"20%\"\n    }\n  }, {\n    key: \"message\",\n    label: \"Message\",\n    _style: {\n      width: \"20%\"\n    }\n  }, {\n    key: \"email\",\n    label: \"Email\",\n    _style: {\n      width: \"20%\"\n    }\n  }, {\n    key: \"name\",\n    label: \"Name\",\n    _style: {\n      width: \"10%\"\n    }\n  }, {\n    key: \"type\",\n    label: \"Type\",\n    _style: {\n      width: \"10%\"\n    }\n  }, {\n    key: 'actions',\n    label: '',\n    _style: {\n      width: '15%'\n    },\n    sorter: false,\n    filter: false\n  }];\n  const [adminid, setAdminId] = React.useState(\"adminid\");\n  const [loading, setLoading] = React.useState(false);\n  const [toast, showToast] = React.useState(false);\n  const [toastMessage, setToastMessage] = React.useState('');\n  const [toastClass, setToastClass] = React.useState('success');\n  const [messageList, setMessageList] = React.useState([]);\n  React.useEffect(() => {\n    if (localStorage.getItem(\"loginUser\")) {\n      var loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\n      setLoginUser(loginUser);\n      console.log(\"loginUser2 ===> \" + JSON.stringify(loginUser));\n      setAdminId(loginUser.userId);\n\n      if (loginUser.userrole !== 'Admin') {\n        history.push('/');\n      }\n    } else {\n      history.push(\"/auth/login-page\");\n    }\n\n    getMessageList();\n  }, []);\n\n  function deleteMessage(item) {\n    console.log(item);\n    setLoading(true);\n    axios({\n      url: Config.BACKEND_API_URL + '/admin/message/delete',\n      method: 'delete',\n      data: {\n        messageid: item.messageid,\n        deletedby: adminid,\n        deletedtime: Date.now().toString()\n      },\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      setToastClass('success');\n      setToastMessage('Success: ' + response.data);\n      showToast(true);\n      setLoading(false);\n    }).catch(function (error) {\n      console.log(error.response); // error.response.data\n\n      setLoading(false);\n    });\n  }\n\n  const getMessageList = async () => {\n    setLoading(true);\n    axios({\n      url: Config.BACKEND_API_URL + '/admin/message/list',\n      method: 'get'\n    }).then(function (response) {\n      const list = response.data.sort((a, b) => a.createdtime > b.createdtime ? 1 : -1);\n      console.log(list);\n      setMessageList(list);\n      setLoading(false);\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"animated fadeIn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    xl: \"12\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CCard, {\n    custom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CCardHeader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, \"Messages\"), /*#__PURE__*/React.createElement(CCardBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CDataTable, {\n    items: messageList,\n    fields: fields,\n    tableFilter: true,\n    itemsPerPageSelect: false,\n    itemsPerPage: currentPagination,\n    dark: false,\n    hover: false,\n    border: false,\n    outlined: false,\n    loading: false,\n    sorter: false,\n    pagination: {\n      doubleArrows: true,\n      align: \"center\"\n    },\n    loading: loading,\n    onPageChange: val => {\n      console.log(\"new page:\", val);\n      setCurrentPage(val);\n    },\n    onPaginationChange: val => {\n      console.log(\"new pagination:\", val);\n      setCurrentPagination(val);\n    },\n    scopedSlots: {\n      'actions': item => {\n        return /*#__PURE__*/React.createElement(\"td\", {\n          className: \"py-2\",\n          style: {\n            display: 'flex',\n            justifyContent: 'flex-end',\n            textAlign: 'right'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(CButton, {\n          size: \"sm\",\n          color: \"danger\",\n          className: \"ml-1\",\n          onClick: e => {\n            e.preventDefault();\n            deleteMessage(item);\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 27\n          }\n        }, \"Delete\"));\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(CRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(CCol, {\n    xs: \"9\",\n    md: \"8\",\n    style: {\n      alignSelf: \"center\",\n      display: \"flex\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"spin\", {\n    style: {\n      marginTop: \"5px\",\n      marginRight: \"5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 19\n    }\n  }, \"Items per page:\"), /*#__PURE__*/React.createElement(CSelect, {\n    name: \"itemsperpage\",\n    id: \"itemsperpage\",\n    style: {\n      width: \"70px\"\n    },\n    onChange: e => setCurrentPagination(e.target.value),\n    value: currentPagination,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 21\n    }\n  }, \"5\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"10\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 21\n    }\n  }, \"10\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"15\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 21\n    }\n  }, \"15\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"20\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 21\n    }\n  }, \"20\"))), /*#__PURE__*/React.createElement(CCol, {\n    xs: \"3\",\n    md: \"4\",\n    style: {\n      alignSelf: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      textAlign: \"right\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"spin\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 21\n    }\n  }, (currentPage - 1) * currentPagination + 1 + \"-\" + getLastVal(currentPage) + \" of \" + messageList.length))))))), /*#__PURE__*/React.createElement(CCol, {\n    sm: \"12\",\n    lg: \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Snackbar, {\n    anchorOrigin: {\n      vertical: 'top',\n      horizontal: 'center'\n    },\n    open: toast,\n    autoHideDuration: 3000,\n    onClose: () => {\n      showToast(false);\n      toast ? getMessageList() : showToast(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Alert, {\n    severity: toastClass,\n    action: /*#__PURE__*/React.createElement(CButton, {\n      onClick: e => {\n        e.preventDefault();\n        showToast(false);\n        getMessageList();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(CIcon, {\n      name: \"cil-x\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 105\n      }\n    })),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 13\n    }\n  }, toastMessage)))));\n}","map":{"version":3,"sources":["D:/CSH/Samples/Theme/ReactTheme/trainingapp/web/src/modules/users/Messages.jsx"],"names":["React","Component","useEffect","CButton","CCard","CCardBody","CCardHeader","CCardFooter","CCol","CRow","CDataTable","CForm","CFormGroup","CFormText","CLink","CInput","CLabel","CSelect","CSpinner","CInputGroup","CInputGroupPrepend","CInputGroupText","CInputFile","Snackbar","NavLink","RouterLink","useHistory","MuiAlert","CIcon","axios","Config","Alert","props","Messages","history","loginUser","setLoginUser","useState","currentPage","setCurrentPage","currentPagination","setCurrentPagination","getLastVal","messageList","length","fields","key","label","_style","width","sorter","filter","adminid","setAdminId","loading","setLoading","toast","showToast","toastMessage","setToastMessage","toastClass","setToastClass","setMessageList","localStorage","getItem","JSON","parse","console","log","stringify","userId","userrole","push","getMessageList","deleteMessage","item","url","BACKEND_API_URL","method","data","messageid","deletedby","deletedtime","Date","now","toString","headers","then","response","catch","error","list","sort","a","b","createdtime","doubleArrows","align","val","display","justifyContent","textAlign","e","preventDefault","alignSelf","marginTop","marginRight","target","value","vertical","horizontal"],"mappings":"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","sourcesContent":["import React, { Component, useEffect } from \"react\";\r\nimport {\r\n  CButton,\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CCardFooter,\r\n  CCol,\r\n  CRow,\r\n  CDataTable,\r\n  CForm,\r\n  CFormGroup,\r\n  CFormText,\r\n  CLink,\r\n  CInput,\r\n  CLabel,\r\n  CSelect,\r\n  CSpinner,\r\n  CInputGroup,\r\n  CInputGroupPrepend,\r\n  CInputGroupText,\r\n  CInputFile\r\n} from \"@coreui/react\";\r\n\r\nimport Snackbar from '@material-ui/core/Snackbar';\r\n\r\nimport { NavLink as RouterLink, useHistory } from \"react-router-dom\";\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport CIcon from '@coreui/icons-react'\r\nimport axios from 'axios';\r\nimport Config from '../../common/Config'\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} {...props} />;\r\n}\r\n\r\nexport default function Messages() {\r\n  const history = useHistory();\r\n  const [loginUser, setLoginUser] = React.useState({})\r\n\r\n  const [currentPage, setCurrentPage] = React.useState(1)\r\n  const [currentPagination, setCurrentPagination] = React.useState(5)\r\n  const getLastVal = (currentPage) => {\r\n    if (currentPage * currentPagination < messageList.length)\r\n      return currentPage * currentPagination;\r\n    return messageList.length;\r\n  }\r\n  const fields = [\r\n    { key: \"subject\", label: \"Subject\", _style: { width: \"20%\" } },\r\n    { key: \"mobilenumber\", label: \"Mobile Number\", _style: { width: \"20%\" } },\r\n    { key: \"message\", label: \"Message\", _style: { width: \"20%\" } },\r\n    { key: \"email\", label: \"Email\", _style: { width: \"20%\" } },\r\n    { key: \"name\", label: \"Name\", _style: { width: \"10%\" } },\r\n    { key: \"type\", label: \"Type\", _style: { width: \"10%\" } },\r\n    {\r\n      key: 'actions',\r\n      label: '',\r\n      _style: { width: '15%' },\r\n      sorter: false,\r\n      filter: false\r\n    },\r\n  ];\r\n  const [adminid, setAdminId] = React.useState(\"adminid\")\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [toast, showToast] = React.useState(false);\r\n  const [toastMessage, setToastMessage] = React.useState('');\r\n  const [toastClass, setToastClass] = React.useState('success');\r\n  const [messageList, setMessageList] = React.useState([]);\r\n  React.useEffect(() => {\r\n    if (localStorage.getItem(\"loginUser\")) {\r\n      var loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n      setLoginUser(loginUser)\r\n      console.log(\"loginUser2 ===> \" + JSON.stringify(loginUser));\r\n      setAdminId(loginUser.userId);\r\n      if(loginUser.userrole !== 'Admin') {\r\n        history.push('/');\r\n      }\r\n    } else {\r\n      history.push(\"/auth/login-page\");\r\n    }\r\n\r\n    getMessageList();\r\n  }, []);\r\n\r\n  function deleteMessage(item){\r\n    console.log(item);\r\n    setLoading(true)\r\n    axios({\r\n      url: Config.BACKEND_API_URL+'/admin/message/delete',\r\n      method: 'delete',\r\n      data: {\r\n        messageid: item.messageid,\r\n        deletedby:adminid,\r\n        deletedtime:Date.now().toString()\r\n      },\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    .then(function (response) {\r\n      setToastClass('success');\r\n      setToastMessage('Success: ' + response.data);\r\n      showToast(true);\r\n      setLoading(false)\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      // error.response.data\r\n      setLoading(false)\r\n    });\r\n  }\r\n\r\n  const getMessageList = async () => {\r\n    setLoading(true)\r\n    axios({\r\n      url: Config.BACKEND_API_URL+'/admin/message/list',\r\n      method: 'get'\r\n    })\r\n    .then(function (response) {\r\n      const list = response.data.sort((a, b) => a.createdtime > b.createdtime ? 1 : -1)\r\n      console.log(list)\r\n      setMessageList(list);\r\n      setLoading(false)\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n  };\r\n\r\n  return (\r\n    <div className=\"animated fadeIn\">\r\n      <CRow>\r\n        <CCol xl=\"12\">\r\n          <CCard custom>\r\n            <CCardHeader>Messages</CCardHeader>\r\n            <CCardBody>\r\n              <CDataTable\r\n                items={messageList}\r\n                fields={fields}\r\n                tableFilter\r\n                itemsPerPageSelect={false}\r\n                itemsPerPage={currentPagination}\r\n                dark={false}\r\n                hover={false}\r\n                border={false}\r\n                outlined={false}\r\n                loading={false}\r\n                sorter={false}\r\n                pagination={{ doubleArrows: true, align: \"center\" }}\r\n                loading={loading}\r\n                onPageChange={val => {\r\n                  console.log(\"new page:\", val);\r\n                  setCurrentPage(val);\r\n                }}\r\n                onPaginationChange={val => {\r\n                  console.log(\"new pagination:\", val);\r\n                  setCurrentPagination(val);\r\n                }}\r\n                scopedSlots={{\r\n                  'actions':\r\n                    item => {\r\n                      return(\r\n                        <td className=\"py-2\" style={{display:'flex',justifyContent: 'flex-end',textAlign:'right'}}>\r\n                          <CButton size=\"sm\" color=\"danger\" className=\"ml-1\" onClick={(e) => { e.preventDefault(); deleteMessage(item) }}>\r\n                            Delete\r\n                          </CButton>\r\n                        </td>\r\n                      )\r\n                    }\r\n                }}\r\n              />\r\n              <CRow>\r\n                <CCol\r\n                  xs=\"9\"\r\n                  md=\"8\"\r\n                  style={{ alignSelf: \"center\", display: \"flex\" }}\r\n                >\r\n                  <spin style={{ marginTop: \"5px\", marginRight: \"5px\" }}>\r\n                    Items per page:\r\n                  </spin>\r\n                  <CSelect\r\n                    name=\"itemsperpage\"\r\n                    id=\"itemsperpage\"\r\n                    style={{ width: \"70px\" }}\r\n                    onChange={e => setCurrentPagination(e.target.value)}\r\n                    value={currentPagination}\r\n                  >\r\n                    <option value=\"5\">5</option>\r\n                    <option value=\"10\">10</option>\r\n                    <option value=\"15\">15</option>\r\n                    <option value=\"20\">20</option>\r\n                  </CSelect>\r\n                </CCol>\r\n                <CCol xs=\"3\" md=\"4\" style={{ alignSelf: \"center\" }}>\r\n                  <div style={{ textAlign: \"right\" }}>\r\n                    <spin>\r\n                      {(currentPage - 1) * currentPagination +\r\n                        1 +\r\n                        \"-\" +\r\n                        getLastVal(currentPage) +\r\n                        \" of \" +\r\n                        messageList.length}\r\n                    </spin>\r\n                  </div>\r\n                </CCol>\r\n              </CRow>\r\n            </CCardBody>\r\n          </CCard>\r\n        </CCol>\r\n\r\n        <CCol sm=\"12\" lg=\"6\">\r\n          <Snackbar\r\n            anchorOrigin={{ vertical: 'top', horizontal: 'center' }}\r\n            open={toast}\r\n            autoHideDuration={3000}\r\n            onClose={() => {\r\n              showToast(false);\r\n              toast ? getMessageList() : showToast(false);\r\n            }}\r\n          >\r\n            <Alert\r\n              severity={toastClass}\r\n              action={\r\n                <CButton  onClick={(e) => { e.preventDefault(); showToast(false); getMessageList();  }}><CIcon name=\"cil-x\" /></CButton>\r\n              }\r\n            >\r\n              {toastMessage}\r\n            </Alert>\r\n          </Snackbar>\r\n        </CCol>\r\n      </CRow>\r\n    </div>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}