{"ast":null,"code":"var _jsxFileName = \"D:\\\\CSH\\\\A\\\\IoT\\\\Web\\\\Training\\\\trainingapp\\\\web\\\\src\\\\modules\\\\website\\\\CourseDetailsPage.js\";\nimport React, { Suspense } from 'react';\nimport { CButton, CContainer, CCard, CCardBody, CCardHeader, CCardFooter, CCol, CRow, CDataTable, CForm, CFormGroup, CFormText, CLink, CInput, CLabel, CSelect, CCollapse, CInputGroup, CInputGroupPrepend, CInputGroupText, CSpinner, CSidebar, CSidebarBrand, CSidebarNav, CSidebarNavDivider, CSidebarNavTitle, CSidebarNavItem, CNavItem, CSidebarNavDropdown, CFade, CHeader, CToggler, CHeaderBrand, CHeaderNav, CHeaderNavItem, CHeaderNavLink, CSubheader, CBreadcrumbRouter } from '@coreui/react';\nimport { Redirect, Route, Switch, useHistory } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport classNames from 'classnames';\nimport TheFooter from '../../layout/TheFooter';\nimport TopicDetailsPage from './TopicsDetailsPage';\nimport CIcon from '@coreui/icons-react';\nimport logo from '../../assets/images/logo.png';\nimport logo_small from '../../assets/images/logo_small.png';\nimport { TheHeaderDropdown } from '../../layout/index';\nimport axios from 'axios';\nconst isloading = /*#__PURE__*/React.createElement(\"div\", {\n  className: \"pt-3 text-center\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: \"sk-spinner sk-spinner-pulse\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }\n}));\n\nconst CourseDetailsPage = props => {\n  const history = useHistory();\n  const darkMode = useSelector(state => state.darkMode);\n  const classes = classNames('c-app c-default-layout', darkMode && 'c-dark-theme');\n  const dispatch = useDispatch();\n  const sidebarShow = useSelector(state => state.sidebarShow);\n\n  const toggleSidebar = () => {\n    const val = [true, 'responsive'].includes(sidebarShow) ? false : 'responsive';\n    dispatch({\n      type: 'set',\n      sidebarShow: val\n    });\n  };\n\n  const toggleSidebarMobile = () => {\n    const val = [false, 'responsive'].includes(sidebarShow) ? true : 'responsive';\n    dispatch({\n      type: 'set',\n      sidebarShow: val\n    });\n  };\n\n  const [loading, setLoading] = React.useState(false);\n  const [sectionList, setSectionList] = React.useState([]);\n  const [topicList, setTopicList] = React.useState([]);\n  const [topic, setTopic] = React.useState(null);\n  const [courseName, setCourseName] = React.useState(\"\");\n  const [displayMode, setDisplayMode] = React.useState(1);\n  const routes = [{\n    path: '/course/:id/:id',\n    name: 'Topic',\n    exact: true,\n    component: TopicDetailsPage\n  }];\n  React.useEffect(() => {\n    // if(localStorage.getItem('topic') != null && localStorage.getItem('topic') != 'null') {\n    //   var topic = JSON.parse(localStorage.getItem('topic'))\n    //   setTopic(topic)\n    // }\n    if (localStorage.getItem('loginUser')) {\n      console.log('loginUser ===> ' + JSON.stringify(localStorage.getItem('loginUser')));\n    } else {// history.push('/auth/login-page');\n      // return;\n    } // getOrderList();\n\n\n    localStorage.setItem('topic', null);\n    getSectionList();\n  }, []);\n\n  const getCourse = async (orderlist, orderitemlist, paymentlist) => {\n    axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/course/details/' + props.match.params.id,\n      method: 'get',\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    }).then(function (response) {\n      console.log(response.data);\n      setCourseName(response.data.coursename);\n      var isPurchased = false;\n      var loginUser = JSON.parse(localStorage.getItem('loginUser'));\n\n      for (var j = 0; j < orderitemlist.length; j++) {\n        if (orderitemlist[j].productid === props.match.params.id) {\n          const order = orderlist.find(order => order.orderid === orderitemlist[j].orderid && order.userid === loginUser.userId);\n\n          if (order) {\n            console.log(order);\n\n            if (order.status === \"Purchased\") {\n              const payment = paymentlist.find(payment => payment.orderitemid === orderitemlist[j].orderitemid);\n              console.log(orderitemlist[j].orderitemid);\n              console.log(payment);\n\n              if (payment) {\n                const date = new Date(Number(payment.updatedtime));\n                date.setMonth(date.getMonth() + parseInt(response.data.expiryduration));\n\n                if (date >= Date.now()) {\n                  isPurchased = true;\n                } else {\n                  isPurchased = false;\n                }\n              } else {\n                isPurchased = false;\n              }\n            } else if (order.status === \"Admin assigned\") {\n              isPurchased = true;\n            } else isPurchased = false;\n\n            break;\n          }\n        }\n      }\n\n      if (isPurchased == true) {\n        localStorage.setItem('topic', null);\n        getSectionList();\n      } else {\n        history.push('/');\n      }\n    }).catch(function (error) {\n      console.log(error.response);\n    });\n  };\n\n  const getPaymentList = async (orderlist, orderitemlist) => {\n    setLoading(true);\n    const paymentList = await axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/payment',\n      method: 'get'\n    }).then(response => response.data).then(data => {\n      setLoading(false);\n      return data.sort((a, b) => a.updatedtime > b.updatedtime ? -1 : 1); //   descending\n    }).catch(error => {\n      setLoading(false);\n    });\n    getCourse(orderlist, orderitemlist, paymentList);\n  };\n\n  const getOrderItemList = async orderlist => {\n    setLoading(true);\n    const list = await axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/orderitem',\n      method: 'get'\n    }).then(function (response) {\n      const list = response.data.sort((a, b) => a.updatedtime > b.updatedtime ? -1 : 1); //descending\n\n      setLoading(false);\n      return list;\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n    getPaymentList(orderlist, list);\n  };\n\n  const getOrderList = async () => {\n    setLoading(true);\n    const list = await axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/order',\n      method: 'get'\n    }).then(function (response) {\n      const list = response.data.sort((a, b) => a.updatedtime > b.updatedtime ? -1 : 1); //descending\n\n      setLoading(false);\n      return list;\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n    getOrderItemList(list);\n  };\n\n  const getSectionList = async () => {\n    setLoading(true);\n    axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/section',\n      method: 'get'\n    }).then(function (response) {\n      const list = response.data.sort((a, b) => a.createdtime > b.createdtime ? 1 : -1); //Ascending\n\n      console.log(list);\n      setSectionList(list.filter(section => section.courseid === props.match.params.id));\n      setLoading(false);\n      getTopicList();\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n  };\n\n  const getTopicList = async () => {\n    setLoading(true);\n    axios({\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/topic',\n      method: 'get'\n    }).then(function (response) {\n      const list = response.data.sort((a, b) => a.createdtime > b.createdtime ? 1 : -1); //Ascending\n\n      console.log(list); // setTopicList(list.filter(topic => topic.sectionid === props.match.params.id));\n\n      setTopicList(list);\n      setLoading(false);\n    }).catch(function (error) {\n      console.log(error.response);\n      setLoading(false);\n    });\n  };\n\n  const handleTopicClick = topic => {\n    setTopic(topic);\n    localStorage.setItem('topic', JSON.stringify(topic));\n  };\n\n  const downloadData = () => {\n    axios({\n      url: process.env.REACT_APP_AWS_BUCKET_CLOUDFRONT_URL + '/' + topic.uploadedfile,\n      method: 'GET',\n      responseType: 'blob' // important\n\n    }).then(response => {\n      const url = window.URL.createObjectURL(new Blob([response.data]));\n      const link = document.createElement('a');\n      link.href = url;\n      link.setAttribute('download', topic.uploadedfile);\n      document.body.appendChild(link);\n      link.click();\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(CSidebar, {\n    show: sidebarShow,\n    unfoldable: true,\n    size: \"lg\",\n    onShowChange: val => dispatch({\n      type: 'set',\n      sidebarShow: val\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CSidebarBrand, {\n    className: \"d-md-down-none\",\n    to: \"/\",\n    style: {\n      background: \"#ced2d8\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CIcon, {\n    className: \"c-sidebar-brand-full\",\n    src: logo,\n    height: 45,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(CIcon, {\n    className: \"c-sidebar-brand-minimized\",\n    src: logo_small,\n    width: 35,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(CSidebarNav, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CSpinner, {\n    grow: true,\n    color: \"primary\",\n    style: {\n      alignSelf: 'center',\n      height: '20',\n      marginTop: \"20px\"\n    },\n    hidden: !loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 11\n    }\n  }), sectionList.map(section => /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 14\n    }\n  }, /*#__PURE__*/React.createElement(CSidebarNavDropdown, {\n    show: \"false\",\n    name: section.sectionname,\n    route: `/course/${props.match.params.id}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 17\n    }\n  }, topicList.filter(topic => topic.sectionid === section.sectionid).map(tp =>\n  /*#__PURE__*/\n  //  <CSidebarNavItem name={topic.topicname} to={`/course/${props.match.params.id}/${topic.topicid}`}  onClick={(e)=> {handleTopicClick(topic);}}/>\n  React.createElement(CSidebarNavItem, {\n    name: tp.topicname,\n    style: {\n      color: topic === null ? \"#ffffffcc\" : topic.topicid === tp.topicid ? \"#fff\" : \"ffffffcc\",\n      background: topic === null ? \"transparent\" : topic.topicid === tp.topicid ? \"#ffffff0d\" : \"transparent\"\n    },\n    onClick: e => {\n      handleTopicClick(tp);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 19\n    }\n  }))))), /*#__PURE__*/React.createElement(CSidebarNavDivider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 310,\n      columnNumber: 11\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"c-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(CHeader, {\n    withSubheader: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(CToggler, {\n    inHeader: true,\n    className: \"ml-md-3 d-lg-none\",\n    onClick: toggleSidebarMobile,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(CToggler, {\n    inHeader: true,\n    className: \"ml-3 d-md-down-none\",\n    onClick: toggleSidebar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(CHeaderBrand, {\n    className: \"mx-auto d-lg-none\",\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CIcon, {\n    src: logo,\n    height: \"48\",\n    alt: \"Logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(CHeaderNav, {\n    className: \"d-md-down-none mr-auto\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CHeaderNavItem, {\n    className: \"px-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 332,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CHeaderNavLink, {\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CIcon, {\n    name: \"cil-home\",\n    className: \"mfe-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 15\n    }\n  }), \"Home\"))), /*#__PURE__*/React.createElement(CHeaderNav, {\n    className: \"px-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(TheHeaderDropdown, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(CSubheader, {\n    className: \"px-3 justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"border-0 c-subheader-nav m-0 px-0 px-md-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"spin\", {\n    style: {\n      whiteSpace: \"pre\",\n      textAlign: \"left\",\n      fontFamily: \"Poppins-Bold\",\n      fontSize: \"130%\",\n      color: \"#058fd1\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 15\n    }\n  }, \" \", 'Course : ' + courseName\n  /*localStorage.getItem('coursename')*/\n  , \" \")), /*#__PURE__*/React.createElement(\"div\", {\n    className: \" mfe-2 c-subheader-nav\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 15\n    }\n  }, topic !== null && topic.video != 'null' ? /*#__PURE__*/React.createElement(CLink, {\n    className: \"c-subheader-nav-link\",\n    href: \"#\",\n    onClick: e => {\n      setDisplayMode(1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 21\n    }\n  }, \"Preview Video\") : '', topic !== null && topic.uploadedfile != 'null' ? /*#__PURE__*/React.createElement(CLink, {\n    className: \"c-subheader-nav-link\",\n    href: \"#\",\n    onClick: e => {\n      setDisplayMode(2);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 21\n    }\n  }, \"Preview File\") : '', topic !== null && topic.uploadedfile != 'null' ? /*#__PURE__*/React.createElement(CLink, {\n    className: \"c-subheader-nav-link\",\n    href: \"#\",\n    onClick: e => {\n      downloadData();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(CIcon, {\n    name: \"cil-CloudDownload\",\n    alt: \"Download\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 23\n    }\n  }), \"\\xA0Download File\") : ''))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"c-body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"main\", {\n    className: \"c-main\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(CContainer, {\n    fluid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(TopicDetailsPage, {\n    displayMode: displayMode,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 17\n    }\n  })))), /*#__PURE__*/React.createElement(TheFooter, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default CourseDetailsPage;","map":{"version":3,"sources":["D:/CSH/A/IoT/Web/Training/trainingapp/web/src/modules/website/CourseDetailsPage.js"],"names":["React","Suspense","CButton","CContainer","CCard","CCardBody","CCardHeader","CCardFooter","CCol","CRow","CDataTable","CForm","CFormGroup","CFormText","CLink","CInput","CLabel","CSelect","CCollapse","CInputGroup","CInputGroupPrepend","CInputGroupText","CSpinner","CSidebar","CSidebarBrand","CSidebarNav","CSidebarNavDivider","CSidebarNavTitle","CSidebarNavItem","CNavItem","CSidebarNavDropdown","CFade","CHeader","CToggler","CHeaderBrand","CHeaderNav","CHeaderNavItem","CHeaderNavLink","CSubheader","CBreadcrumbRouter","Redirect","Route","Switch","useHistory","useSelector","useDispatch","classNames","TheFooter","TopicDetailsPage","CIcon","logo","logo_small","TheHeaderDropdown","axios","isloading","CourseDetailsPage","props","history","darkMode","state","classes","dispatch","sidebarShow","toggleSidebar","val","includes","type","toggleSidebarMobile","loading","setLoading","useState","sectionList","setSectionList","topicList","setTopicList","topic","setTopic","courseName","setCourseName","displayMode","setDisplayMode","routes","path","name","exact","component","useEffect","localStorage","getItem","console","log","JSON","stringify","setItem","getSectionList","getCourse","orderlist","orderitemlist","paymentlist","url","process","env","REACT_APP_AWS_API_ENDPOINT","match","params","id","method","headers","then","response","data","coursename","isPurchased","loginUser","parse","j","length","productid","order","find","orderid","userid","userId","status","payment","orderitemid","date","Date","Number","updatedtime","setMonth","getMonth","parseInt","expiryduration","now","push","catch","error","getPaymentList","paymentList","sort","a","b","getOrderItemList","list","getOrderList","createdtime","filter","section","courseid","getTopicList","handleTopicClick","downloadData","REACT_APP_AWS_BUCKET_CLOUDFRONT_URL","uploadedfile","responseType","window","URL","createObjectURL","Blob","link","document","createElement","href","setAttribute","body","appendChild","click","background","alignSelf","height","marginTop","map","sectionname","sectionid","tp","topicname","color","topicid","e","whiteSpace","textAlign","fontFamily","fontSize","video"],"mappings":"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","sourcesContent":["import React, { Suspense } from 'react'\r\nimport {\r\n  CButton,\r\n  CContainer,\r\n  CCard,\r\n  CCardBody,\r\n  CCardHeader,\r\n  CCardFooter,\r\n  CCol,\r\n  CRow, CDataTable, CForm, CFormGroup, CFormText, CLink, CInput, CLabel, CSelect,\r\n  CCollapse,\r\n  CInputGroup,\r\n  CInputGroupPrepend,\r\n  CInputGroupText,\r\n  CSpinner,\r\n  CSidebar,\r\n  CSidebarBrand,\r\n  CSidebarNav,\r\n  CSidebarNavDivider,\r\n  CSidebarNavTitle,\r\n  CSidebarNavItem,\r\n  CNavItem,\r\n  CSidebarNavDropdown,\r\n  CFade,\r\n  CHeader,\r\n  CToggler,\r\n  CHeaderBrand,\r\n  CHeaderNav,\r\n  CHeaderNavItem,\r\n  CHeaderNavLink,\r\n  CSubheader,\r\n  CBreadcrumbRouter\r\n} from '@coreui/react';\r\n\r\nimport {\r\n  Redirect,\r\n  Route,\r\n  Switch,\r\n  useHistory\r\n} from 'react-router-dom'\r\n\r\nimport { useSelector, useDispatch } from 'react-redux'\r\nimport classNames from 'classnames'\r\nimport TheFooter from '../../layout/TheFooter'\r\nimport TopicDetailsPage from './TopicsDetailsPage'\r\nimport CIcon from '@coreui/icons-react'\r\nimport logo from '../../assets/images/logo.png'\r\nimport logo_small from '../../assets/images/logo_small.png'\r\nimport {\r\n  TheHeaderDropdown\r\n}  from '../../layout/index'\r\n\r\nimport axios from 'axios';\r\n\r\nconst isloading = (\r\n  <div className=\"pt-3 text-center\">\r\n    <div className=\"sk-spinner sk-spinner-pulse\"></div>\r\n  </div>\r\n)\r\n\r\nconst CourseDetailsPage = (props) => {\r\n  const history = useHistory();\r\n\r\n  const darkMode = useSelector(state => state.darkMode)\r\n  const classes = classNames(\r\n    'c-app c-default-layout',\r\n    darkMode && 'c-dark-theme'\r\n  )\r\n  const dispatch = useDispatch()\r\n  const sidebarShow = useSelector(state => state.sidebarShow)\r\n  const toggleSidebar = () => {\r\n    const val = [true, 'responsive'].includes(sidebarShow) ? false : 'responsive'\r\n    dispatch({type: 'set', sidebarShow: val})\r\n  }\r\n\r\n  const toggleSidebarMobile = () => {\r\n    const val = [false, 'responsive'].includes(sidebarShow) ? true : 'responsive'\r\n    dispatch({type: 'set', sidebarShow: val})\r\n  }\r\n  \r\n  const [loading, setLoading] = React.useState(false)\r\n  const [sectionList, setSectionList] = React.useState([])\r\n  const [topicList, setTopicList] = React.useState([])\r\n  const [topic, setTopic] = React.useState(null)\r\n  const [courseName, setCourseName] = React.useState(\"\")\r\n  const [displayMode, setDisplayMode] = React.useState(1)\r\n\r\n  const routes = [\r\n    { path: '/course/:id/:id', name: 'Topic',  exact: true, component: TopicDetailsPage },\r\n  ]\r\n\r\n  React.useEffect(() => {\r\n    // if(localStorage.getItem('topic') != null && localStorage.getItem('topic') != 'null') {\r\n    //   var topic = JSON.parse(localStorage.getItem('topic'))\r\n    //   setTopic(topic)\r\n    // }\r\n    if(localStorage.getItem('loginUser')) {\r\n      console.log('loginUser ===> ' + JSON.stringify(localStorage.getItem('loginUser')));\r\n    } else {\r\n      // history.push('/auth/login-page');\r\n      // return;\r\n    }\r\n\r\n    // getOrderList();\r\n    localStorage.setItem('topic', null);           \r\n    getSectionList();\r\n  }, []);\r\n\r\n  const getCourse = async (orderlist, orderitemlist, paymentlist) => {\r\n    axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT+'/course/details/'+props.match.params.id,\r\n      method: 'get' ,\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      }\r\n    })\r\n    .then(function (response) {\r\n      console.log(response.data)\r\n      setCourseName(response.data.coursename)\r\n\r\n      var isPurchased = false;\r\n      var loginUser = JSON.parse(localStorage.getItem('loginUser'))\r\n      for(var j=0;j<orderitemlist.length;j++) {\r\n        if(orderitemlist[j].productid === props.match.params.id) {\r\n            const order = orderlist.find(order => (order.orderid === orderitemlist[j].orderid) && (order.userid === loginUser.userId))\r\n            if(order) {\r\n              console.log(order)\r\n              if(order.status === \"Purchased\" ) {                    \r\n                const payment = paymentlist.find(payment => payment.orderitemid === orderitemlist[j].orderitemid)\r\n                console.log(orderitemlist[j].orderitemid)\r\n                console.log(payment)\r\n                if(payment) {\r\n                  const date =  new Date(Number(payment.updatedtime));\r\n                  date.setMonth(date.getMonth() + parseInt(response.data.expiryduration))\r\n                  if(date >= Date.now()) {\r\n                    isPurchased = true\r\n                  } else {\r\n                    isPurchased = false\r\n                  }\r\n                } else {\r\n                  isPurchased = false\r\n                }\r\n              } else if(order.status === \"Admin assigned\" ) {\r\n                isPurchased = true\r\n              } else isPurchased = false\r\n  \r\n              break;\r\n            }\r\n        }\r\n      }\r\n      if(isPurchased == true ) {\r\n        localStorage.setItem('topic', null);           \r\n        getSectionList();\r\n      } else {\r\n        history.push('/');\r\n      }      \r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n     });\r\n  };\r\n\r\n\r\n  const getPaymentList = async (orderlist, orderitemlist) => {\r\n    setLoading(true)\r\n    const paymentList = await axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT + '/payment',\r\n      method: 'get'\r\n    }).then(response => response.data).then((data) => {\r\n      setLoading(false)\r\n      return data.sort((a, b) => a.updatedtime > b.updatedtime ? -1 : 1)   //   descending\r\n    }).catch(error => {\r\n      setLoading(false)\r\n    });\r\n\r\n    getCourse(orderlist, orderitemlist, paymentList);\r\n  };\r\n\r\n  const getOrderItemList = async (orderlist) => {\r\n    setLoading(true)\r\n    const list = await axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT+'/orderitem',\r\n      method: 'get'\r\n    })\r\n    .then(function (response) {\r\n      const list = response.data.sort((a, b) => a.updatedtime > b.updatedtime ? -1 : 1) //descending\r\n      setLoading(false)\r\n      return list\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n\r\n     getPaymentList(orderlist, list)\r\n  };\r\n\r\n  const getOrderList = async () => {\r\n    setLoading(true)\r\n    const list = await axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT+'/order',\r\n      method: 'get'\r\n    })\r\n    .then(function (response) {\r\n      const list = response.data.sort((a, b) => a.updatedtime > b.updatedtime ? -1 : 1) //descending\r\n      setLoading(false)\r\n      return list\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n\r\n     getOrderItemList(list);\r\n  };\r\n\r\n  const getSectionList = async () => {\r\n    setLoading(true)\r\n    axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT+'/section',\r\n      method: 'get'\r\n    })\r\n    .then(function (response) {      \r\n      const list = response.data.sort((a, b) => a.createdtime > b.createdtime ? 1 : -1) //Ascending\r\n      console.log(list)    \r\n      setSectionList(list.filter(section => section.courseid === props.match.params.id));\r\n      setLoading(false)\r\n      getTopicList();\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n  };\r\n\r\n  const getTopicList = async () => {\r\n\r\n    setLoading(true)\r\n    axios({\r\n      url: process.env.REACT_APP_AWS_API_ENDPOINT+'/topic',\r\n      method: 'get'\r\n    })\r\n    .then(function (response) {      \r\n      const list = response.data.sort((a, b) => a.createdtime > b.createdtime ? 1 : -1) //Ascending\r\n      console.log(list)\r\n      // setTopicList(list.filter(topic => topic.sectionid === props.match.params.id));\r\n      setTopicList(list)\r\n      setLoading(false)\r\n    })\r\n    .catch(function (error) {\r\n      console.log(error.response)\r\n      setLoading(false)\r\n     });\r\n  };\r\n\r\n  const handleTopicClick = (topic) => {\r\n    setTopic(topic)\r\n    localStorage.setItem('topic', JSON.stringify(topic));\r\n  }\r\n\r\n  const downloadData = () => {\r\n    axios({\r\n      url: process.env.REACT_APP_AWS_BUCKET_CLOUDFRONT_URL + '/' + topic.uploadedfile,\r\n      method: 'GET',\r\n      responseType: 'blob', // important\r\n    }).then((response) => {\r\n      const url = window.URL.createObjectURL(new Blob([response.data]));\r\n      const link = document.createElement('a');\r\n      link.href = url;\r\n      link.setAttribute('download', topic.uploadedfile);\r\n      document.body.appendChild(link);\r\n      link.click();\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div className={classes}>\r\n      <CSidebar\r\n        show={sidebarShow}\r\n        unfoldable\r\n        size=\"lg\"\r\n        onShowChange={(val) => dispatch({type: 'set', sidebarShow: val })}>\r\n\r\n        <CSidebarBrand className=\"d-md-down-none\" to=\"/\" style={{background:\"#ced2d8\"}}>\r\n          <CIcon\r\n            className=\"c-sidebar-brand-full\"\r\n            src={logo}\r\n            height={45}\r\n          />\r\n          <CIcon\r\n            className=\"c-sidebar-brand-minimized\"\r\n            src={logo_small}\r\n            width={35}\r\n          />\r\n        </CSidebarBrand>\r\n        <CSidebarNav >\r\n          <CSpinner grow color=\"primary\" style={{alignSelf:'center', height:'20', marginTop:\"20px\"}} hidden={!loading}/>             \r\n          {/* {section.sectionname} */}\r\n          {sectionList.map(section=>( \r\n             <div>\r\n                <CSidebarNavDropdown  show=\"false\"  name= {section.sectionname}  route={`/course/${props.match.params.id}`}>\r\n                {/* filter(topic => topic.sectionid === section.sectionid). */}\r\n                 {topicList.filter(topic => topic.sectionid === section.sectionid).map(tp=>(\r\n                  //  <CSidebarNavItem name={topic.topicname} to={`/course/${props.match.params.id}/${topic.topicid}`}  onClick={(e)=> {handleTopicClick(topic);}}/>\r\n                  <CSidebarNavItem name={tp.topicname} style={{color:topic===null?\"#ffffffcc\":topic.topicid===tp.topicid?\"#fff\":\"ffffffcc\" , background:topic===null?\"transparent\":topic.topicid===tp.topicid?\"#ffffff0d\":\"transparent\"}} onClick={(e)=> {handleTopicClick(tp);}}/>\r\n                ))}\r\n                </CSidebarNavDropdown>                 \r\n             </div>\r\n           ))}\r\n          <CSidebarNavDivider />\r\n        </CSidebarNav>\r\n      </CSidebar>\r\n      <div className=\"c-wrapper\">\r\n        {/* <CourseDetailsHeader/> */}\r\n        <CHeader withSubheader>\r\n          <CToggler\r\n            inHeader\r\n            className=\"ml-md-3 d-lg-none\"\r\n            onClick={toggleSidebarMobile}\r\n          />\r\n          <CToggler\r\n            inHeader\r\n            className=\"ml-3 d-md-down-none\"\r\n            onClick={toggleSidebar}\r\n          />\r\n          <CHeaderBrand className=\"mx-auto d-lg-none\" to=\"/\">\r\n            <CIcon src={logo} height=\"48\" alt=\"Logo\"/>\r\n            {/* <CIcon name='logo' height=\"48\" alt=\"Logo\"/> */}\r\n          </CHeaderBrand>\r\n\r\n          <CHeaderNav className=\"d-md-down-none mr-auto\">\r\n            <CHeaderNavItem className=\"px-3\" >\r\n            <CHeaderNavLink to=\"/\">\r\n              <CIcon name=\"cil-home\" className=\"mfe-2\" />\r\n                Home\r\n              </CHeaderNavLink>\r\n            </CHeaderNavItem>\r\n          </CHeaderNav>\r\n\r\n          <CHeaderNav className=\"px-3\">\r\n            <TheHeaderDropdown/>\r\n          </CHeaderNav>\r\n\r\n          <CSubheader className=\"px-3 justify-content-between\">\r\n            {/* <CBreadcrumbRouter className=\"border-0 c-subheader-nav m-0 px-0 px-md-3\" routes={routes} /> */}\r\n            <div className=\"border-0 c-subheader-nav m-0 px-0 px-md-3\"  >\r\n              <spin style={{whiteSpace: \"pre\",textAlign:\"left\", fontFamily:\"Poppins-Bold\", fontSize:\"130%\", color:\"#058fd1\"}}> {'Course : ' + courseName/*localStorage.getItem('coursename')*/} </spin>\r\n            </div>\r\n              <div className=\" mfe-2 c-subheader-nav\">\r\n                {\r\n                  topic !== null && topic.video != 'null' ?\r\n                    <CLink className=\"c-subheader-nav-link\" href=\"#\" onClick={((e)=>{ setDisplayMode(1) })}>\r\n                      Preview Video\r\n                    </CLink>\r\n                  :''\r\n                }\r\n                {\r\n                topic !== null && topic.uploadedfile != 'null' ?\r\n                    <CLink className=\"c-subheader-nav-link\" href=\"#\" onClick={((e)=>{ setDisplayMode(2) })}>\r\n                      Preview File\r\n                    </CLink>\r\n                : ''\r\n                }\r\n                {\r\n                topic !== null && topic.uploadedfile != 'null' ?\r\n                    <CLink className=\"c-subheader-nav-link\" href=\"#\" onClick={((e)=>{downloadData()})}>\r\n                      <CIcon name=\"cil-CloudDownload\" alt=\"Download\" />&nbsp;Download File\r\n                    </CLink>\r\n                : ''\r\n                }\r\n              </div>              \r\n          </CSubheader>\r\n        </CHeader>\r\n        <div className=\"c-body\">\r\n          <main className=\"c-main\">\r\n            <CContainer fluid>              \r\n                {/* <Suspense fallback={isloading}>\r\n                  {routes.map((route, idx) => {\r\n                    return route.component && (\r\n                      <Route\r\n                        key={idx}\r\n                        path={route.path}\r\n                        exact={route.exact}\r\n                        name={route.name}\r\n                        render={props => (\r\n                          <CFade>\r\n                            <route.component {...props}/>\r\n                          </CFade>\r\n                        )} />\r\n                    )\r\n                  })}\r\n                </Suspense> */}\r\n                <TopicDetailsPage displayMode={displayMode}/>\r\n            </CContainer>\r\n          </main>              \r\n        </div>\r\n        <TheFooter/>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default CourseDetailsPage\r\n"]},"metadata":{},"sourceType":"module"}